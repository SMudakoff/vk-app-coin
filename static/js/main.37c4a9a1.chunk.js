(this.webpackJsonpmy_mini_app=this.webpackJsonpmy_mini_app||[]).push([[0],{113:function(e,t,a){e.exports=a.p+"static/media/roll.b528eaf8.svg"},117:function(e,t,a){e.exports=a(224)},215:function(e,t,a){},217:function(e,t,a){},224:function(e,t,a){"use strict";a.r(t);a(118),a(144),a(146),a(147),a(149),a(150),a(151),a(152),a(153),a(154),a(155),a(156),a(158),a(159),a(160),a(161),a(162),a(163),a(164),a(165),a(166),a(167),a(169),a(170),a(171),a(172),a(173),a(174),a(175),a(176),a(177),a(178),a(179),a(180),a(181),a(182),a(183),a(184),a(185),a(186);var n=a(0),r=a.n(n),c=a(112),o=a.n(c),l=a(17),i=a.n(l),s=a(23),u=a.n(s),m=a(45),p=a(14),f=a(81),b=a.n(f),h=a(46),d=a.n(h),E=a(34),v=a.n(E),y=a(115),O=a.n(y),g=a(83),S=a.n(g),j=(a(195),a(58)),k=a.n(j),C=a(59),w=a.n(C),x=a(116),A=a(60),N=a.n(A),V=a(61),z=a.n(V),_=a(57),P=a.n(_),I=a(56),K=a.n(I),W=a(44),J=a.n(W),T=a(52),U=a.n(T),B=a(114),H=a.n(B),D=a(62),F=a.n(D),G=a(82),L=a.n(G),M=a(113),q=a.n(M),Q=i.a.supports("VKWebAppTapticNotificationOccurred");function R(e,t){var a,n,r=!1;return function c(){if(r)return a=arguments,void(n=this);r=!0,e.apply(this,arguments),setTimeout((function(){r=!1,a&&(c.apply(n,a),a=n=null)}),t)}}var X=function(e){var t=e.fetchedState,a=e.snackbarError,c=Object(n.useState)(t.hasOwnProperty("rollsCount")?t.rollsCount:4),o=Object(p.a)(c,2),l=o[0],s=o[1],f=Object(n.useState)(t.hasOwnProperty("toiletVisits")?t.toiletVisits:3),b=Object(p.a)(f,2),h=b[0],E=b[1],y=Object(n.useState)(t.hasOwnProperty("personsCount")?t.personsCount:2),O=Object(p.a)(y,2),g=O[0],S=O[1],j=Object(n.useState)(t.hasOwnProperty("sheetsCount")?t.sheetsCount:640),k=Object(p.a)(j,2),C=k[0],w=k[1],A=Object(n.useState)(a),V=Object(p.a)(A,2),_=V[0],I=V[1],W=function(){var e=Object(m.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Q){e.next=3;break}return e.next=3,i.a.send("VKWebAppTapticNotificationOccurred",{type:C<=0?"error":"success"});case 3:if(!(C<=0)){e.next=7;break}return I(r.a.createElement(d.a,{layout:"vertical",onClose:function(){return I(null)},before:r.a.createElement(v.a,{size:24,style:{backgroundColor:"var(--accent)"}},r.a.createElement(L.a,{fill:"#fff",width:14,height:14})),duration:900},"\u0423 \u0432\u0430\u0441 \u043d\u0435 \u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c \u0442\u0443\u0430\u043b\u0435\u0442\u043a\u0438")),s(0),e.abrupt("return");case 7:t=C-1,a=Math.floor(t/160),w(t),l!==a&&0!==a&&s(a),I(r.a.createElement(d.a,{layout:"vertical",onClose:function(){return I(null)},before:r.a.createElement(v.a,{size:24,style:{backgroundColor:"var(--accent)"}},r.a.createElement(L.a,{fill:"#fff",width:14,height:14})),duration:900},t<=0?"\u0423 \u0432\u0430\u0441 \u043d\u0435 \u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c \u0442\u0443\u0430\u043b\u0435\u0442\u043a\u0438":"\u041b\u0438\u0441\u0442\u043e\u0447\u0435\u043a \u0442\u0443\u0430\u043b\u0435\u0442\u043a\u0438 \u043f\u043e\u0442\u0440\u0430\u0447\u0435\u043d, \u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c ".concat(t))),T({sheetsCount:t});case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(m.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.send("VKWebAppStorageSet",{key:"state",value:JSON.stringify(Object(x.a)({rollsCount:l,toiletVisits:h,personsCount:g,sheetsCount:C},t))});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=R((function(e){e!==l&&(w(C+160*(e-l)),s(e),T())}),200),D=R((function(e){e!==h&&(E(e),T())}),200),G=R((function(e){e!==g&&(S(e),T())}),200);return r.a.createElement(n.Fragment,null,r.a.createElement(K.a,null,r.a.createElement("h1",{className:"DaysLeftHeading"},function(){var e=7*h*g,t=160*l;return Math.round(t/e)}()),r.a.createElement("h3",{className:"DaysLeftSubheading"},"\u0421\u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043d\u0435\u0439 \u0432\u044b \u043f\u0440\u043e\u0434\u0435\u0440\u0436\u0438\u0442\u0435\u0441\u044c")),r.a.createElement(H.a,null,r.a.createElement(N.a,{step:1,min:0,max:48,value:l,top:r.a.createElement(z.a,{indicator:r.a.createElement(F.a,{size:"m",mode:"primary"},l)},r.a.createElement("span",{role:"img","aria-label":"Toilet paper"},"\ud83e\uddfb")," \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0440\u0443\u043b\u043e\u043d\u043e\u0432"),onChange:function(e){return B(e)}}),r.a.createElement(N.a,{step:1,min:1,max:8,value:h,top:r.a.createElement(z.a,{indicator:r.a.createElement(F.a,{size:"m",mode:"primary"},h)},r.a.createElement("span",{role:"img","aria-label":"Poo"},"\ud83d\udca9")," \u041f\u043e\u0441\u0435\u0449\u0435\u043d\u0438\u0439 \u0442\u0443\u0430\u043b\u0435\u0442\u0430 \u0432 \u0434\u0435\u043d\u044c"),onChange:function(e){return D(e)}}),r.a.createElement(N.a,{step:1,min:1,max:16,value:g,top:r.a.createElement(z.a,{indicator:r.a.createElement(F.a,{size:"m",mode:"primary"},g)},r.a.createElement("span",{role:"img","aria-label":"People in household"},"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66")," \u041b\u044e\u0434\u0435\u0439 \u0434\u043e\u043c\u0430"),onChange:function(e){return G(e)}})),r.a.createElement(J.a,{vertical:"bottom"},r.a.createElement(U.a,{className:"PooBtnContainer"},r.a.createElement(P.a,{className:"PooBtn",size:"xl",onClick:W},r.a.createElement("img",{src:q.a,alt:"Toilet paper roll"})))),_)},Y=(a(215),function(e){var t=e.id,a=e.snackbarError,n=e.fetchedState;return r.a.createElement(k.a,{id:t},r.a.createElement(w.a,null,"\u0422\u0443\u0430\u043b\u0435\u0442\u043a\u0430"),n&&r.a.createElement(X,{fetchedState:n,snackbarError:a}))}),Z=(a(217),function(e){var t=e.id,a=e.go,c=e.route,o=e.fetchedUser,l=e.userHasSeenIntro;return r.a.createElement(k.a,{id:t,centered:!0},r.a.createElement(w.a,null,"\u0422\u0443\u0430\u043b\u0435\u0442\u043a\u0430"),o&&!l&&r.a.createElement(n.Fragment,null,r.a.createElement(K.a,null,r.a.createElement(U.a,{className:"User"},o.photo_200?r.a.createElement(v.a,{src:o.photo_200}):null,r.a.createElement("h2",null,"\u041f\u0440\u0438\u0432\u0435\u0442, ",o.first_name),r.a.createElement("h3",null,"\u042d\u0442\u043e\u0442 \u0441\u0435\u0440\u0432\u0438\u0441 \u043f\u043e\u043c\u043e\u0433\u0430\u0435\u0442 \u0441\u043b\u0435\u0434\u0438\u0442\u044c \u0437\u0430 \u0442\u0435\u043c, \u0447\u0442\u043e\u0431\u044b \u0442\u0443\u0430\u043b\u0435\u0442\u043d\u0430\u044f \u0431\u0443\u043c\u0430\u0433\u0430 \u0434\u043e\u043c\u0430 \u043d\u0435 \u0437\u0430\u043a\u0430\u043d\u0447\u0438\u0432\u0430\u043b\u0430\u0441\u044c \u0438 \u0442\u044b \u043d\u0435 \u043f\u043e\u043f\u0430\u043b \u0432 \u043d\u0435\u043b\u043e\u0432\u043a\u0443\u044e \u0441\u0438\u0442\u0443\u0430\u0446\u0438\u044e, \u043a\u043e\u0433\u0434\u0430 \u0435\u0435 \u043d\u0435 \u043e\u043a\u0430\u0436\u0435\u0442\u0441\u044f \u0432 \u0441\u0430\u043c\u044b\u0439 \u043d\u0443\u0436\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442."))),r.a.createElement(J.a,{vertical:"bottom"},r.a.createElement(U.a,null,r.a.createElement(P.a,{mode:"commerce",size:"xl",level:"2",onClick:function(){return a(c)}},"\u041e\u041a, \u0432\u0441\u0451 \u043f\u043e\u043d\u044f\u0442\u043d\u043e")))))}),$="home",ee="intro",te="state",ae="viewStatus",ne=function(){var e=Object(n.useState)(ee),t=Object(p.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(null),l=Object(p.a)(o,2),s=l[0],f=l[1],h=Object(n.useState)(null),E=Object(p.a)(h,2),y=E[0],g=E[1],j=Object(n.useState)(null),k=Object(p.a)(j,2),C=k[0],w=k[1],x=Object(n.useState)(r.a.createElement(O.a,{size:"large"})),A=Object(p.a)(x,2),N=A[0],V=A[1],z=Object(n.useState)(!1),_=Object(p.a)(z,2),P=_[0],I=_[1];Object(n.useEffect)((function(){function e(){return(e=Object(m.a)(u.a.mark((function e(){var t,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.send("VKWebAppGetUserInfo");case 2:return t=e.sent,e.next=5,i.a.send("VKWebAppStorageGet",{keys:[te,ae]});case 5:a=e.sent,Array.isArray(a.keys)?(n={},a.keys.forEach((function(e){var t=e.key,a=e.value;try{switch(n[t]=a?JSON.parse(a):{},t){case te:g(n[te]);break;case ae:n[t]&&n[t].hasSeenIntro&&(c($),I(!0))}}catch(o){w(r.a.createElement(d.a,{layout:"vertical",onClose:function(){return w(null)},before:r.a.createElement(v.a,{size:24,style:{backgroundColor:"var(--dynamic_red)"}},r.a.createElement(S.a,{fill:"#fff",width:14,height:14})),duration:900},"\u041f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 \u0441 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 Storage")),g({})}}))):g({}),f(t),V(null);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}i.a.subscribe((function(e){var t=e.detail,a=t.type,n=t.data;if("VKWebAppUpdateConfig"===a){var r=document.createAttribute("scheme");r.value=n.scheme?n.scheme:"client_light",document.body.attributes.setNamedItem(r)}})),function(){e.apply(this,arguments)}()}),[]);var K=function(e){c(e)},W=function(){var e=Object(m.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.a.send("VKWebAppStorageSet",{key:ae,value:JSON.stringify({hasSeenIntro:!0})});case 3:K(t),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),w(r.a.createElement(d.a,{layout:"vertical",onClose:function(){return w(null)},before:r.a.createElement(v.a,{size:24,style:{backgroundColor:"var(--dynamic_red)"}},r.a.createElement(S.a,{fill:"#fff",width:14,height:14})),duration:900},"\u041f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 \u0441 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u043e\u0439 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 Storage"));case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(b.a,{activePanel:a,popout:N},r.a.createElement(Y,{id:$,fetchedState:y,snackbarError:C}),r.a.createElement(Z,{id:ee,fetchedUser:s,go:W,route:$,userHasSeenIntro:P}))};i.a.send("VKWebAppInit"),o.a.render(r.a.createElement(ne,null),document.getElementById("root"))}},[[117,1,2]]]);
//# sourceMappingURL=main.37c4a9a1.chunk.js.map